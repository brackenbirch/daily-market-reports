name: Daily Market Summary

on:
  workflow_dispatch:
  schedule:
    - cron: '0 11 * * 1-5'

jobs:
  generate-report:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      
    - name: Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: Install packages
      run: pip install anthropic yfinance pandas tabulate
        
    - name: Create enhanced market report
      env:
        ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
      run: |
        python << 'SCRIPT_END'
        import yfinance as yf
        import anthropic
        import os
        import pandas as pd
        from datetime import datetime, timedelta
        from tabulate import tabulate
        import json
        
        def fetch_market_data():
            print("Fetching comprehensive market data...")
            
            tickers = {
                '^GSPC': {'name': 'S&P 500', 'region': 'US'},
                '^IXIC': {'name': 'NASDAQ', 'region': 'US'},
                '^DJI': {'name': 'Dow Jones', 'region': 'US'},
                '^N225': {'name': 'Nikkei 225', 'region': 'Asia'},
                '^HSI': {'name': 'Hang Seng', 'region': 'Asia'},
                '000001.SS': {'name': 'Shanghai Composite', 'region': 'Asia'},
                '^AXJO': {'name': 'ASX 200', 'region': 'Asia'},
                '^FTSE': {'name': 'FTSE 100', 'region': 'Europe'},
                '^GDAXI': {'name': 'DAX', 'region': 'Europe'},
                '^FCHI': {'name': 'CAC 40', 'region': 'Europe'},
                'EURUSD=X': {'name': 'EUR/USD', 'region': 'Currency'},
                'GBPUSD=X': {'name': 'GBP/USD', 'region': 'Currency'},
                'JPY=X': {'name': 'USD/JPY', 'region': 'Curre
